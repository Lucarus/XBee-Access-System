<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css">
    <style>
      /* Palette generated by Material Palette - materialpalette.com/deep-purple/blue */
      .dark-primary-color      { background: #00796B; }
      .text-dark-primary-color { color: #00796B; }
      .default-primary-color   { background: #009688; }
      .light-primary-color     { background: #B2DFDB; }
      .text-primary-color      { color: #FFFFFF; }
      .accent-color            { background: #607D8B; }
      .primary-text-color      { color: #212121; }
      .secondary-text-color    { color: #757575; }
      .divider-color           { border-color: #BDBDBD; }
      .noAccess                { color: tomato; }
      .biggerText              { font-size: 1.4em; }

      body {
        padding: 5px;
      }

      ul {
        list-style-type: none;
        margin: 0;
        padding: 0;
      }

      li {
        border-radius: 5px;
        margin: 10px 0;
      }

      hr {
        display: block;
        height: 1px;
        border: 0;
        border-top: 1px solid #BDBDBD; /* divider-color */
        margin: 1em 0;
        padding: 0;
      }

    </style>
    <title>Zugriffe</title>
  </head>
  <body>
    <ul></ul>
    <script>
    // For todays date;
    Date.prototype.today = function () {
      return ((this.getDate() < 10)?"0":"") + this.getDate() +"/"+(((this.getMonth()+1) < 10)?"0":"") + (this.getMonth()+1) +"/"+ this.getFullYear();
    }

    // For the time now
    Date.prototype.timeNow = function () {
      return ((this.getHours() < 10)?"0":"") + this.getHours() +":"+ ((this.getMinutes() < 10)?"0":"") + this.getMinutes() +":"+ ((this.getSeconds() < 10)?"0":"") + this.getSeconds();
    }

      var ws = new WebSocket("ws://192.168.2.42:5678/")
      var mainContainer = document.getElementsByTagName("ul")[0];

      ws.onmessage = function (event) {
        //event.data
        var newAccess = document.createElement('li');
        var informationDiv = document.createElement('div');
        var message = JSON.parse(event.data);
        console.log(message);
        var usedIcon = message.access == 0 ? "fa-times noAccess" : "fa-check text-dark-primary-color"
        informationDiv.innerHTML = '<i class="biggerText fa ' + usedIcon + '" aria-hidden="true"></i><span class="primary-text-color biggerText">'+ message.benutzer.vorname + " " + message.benutzer.nachname +'</span><br /><span class="secondary-text-color">'+ new Date().timeNow() +"</span><hr />"
        newAccess.appendChild(informationDiv);
        if (message.access == 0) {
          newAccess.setAttribute("class", "noAccess");
        }
        mainContainer.appendChild(newAccess);
      };
    </script>
  </body>
</html>
